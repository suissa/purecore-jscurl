# Relatório de Correção de Erros - jscurl

**Data:** 04-01-2026 15:09  
**Projeto:** jscurl (r3q)  
**Objetivo:** Corrigir todos os erros de TypeScript encontrados no projeto

## O que foi feito

### 1. Correção do import do módulo `querystring`
**Problema:** O módulo `querystring` não existe no ambiente ESNext/Browser, causando erro de compilação.

**Solução:** Substituído por `URLSearchParams`, que é nativo do JavaScript moderno e funciona tanto em Node.js quanto em browsers.

**Código alterado:**
- Removido: `import { stringify } from "querystring";`
- Implementado: Uso de `URLSearchParams` para construir query strings

### 2. Adição da propriedade `url` ao `R3qRequestConfig`
**Problema:** A interface `R3qRequestConfig` não possuía a propriedade `url`, mas o código tentava acessá-la.

**Solução:** Adicionada a propriedade opcional `url?: string | Url;` à interface `R3qRequestConfig` em `src/types.ts`.

### 3. Correção da verificação de `InitBody`
**Problema:** `InitBody` não existe como tipo ou classe no TypeScript/JavaScript, causando erro de referência.

**Solução:** Implementada verificação explícita usando `instanceof` para verificar se o body é um dos tipos nativos de `BodyInit`:
- `FormData`
- `URLSearchParams`
- `Blob`
- `ArrayBuffer`
- `ArrayBufferView`

### 4. Correção da sobrecarga dos métodos HTTP
**Problema:** Os métodos `get`, `post`, `put`, etc. estavam passando `url` dentro do objeto `config`, mas a função principal esperava `url` como primeiro parâmetro separado.

**Solução:** Corrigidos todos os métodos para passar `url` como primeiro parâmetro e `config` como segundo, seguindo a assinatura correta da interface `R3qInstance`.

**Métodos corrigidos:**
- `get(url, config)`
- `delete(url, config)`
- `head(url, config)`
- `options(url, config)`
- `post(url, data, config)`
- `put(url, data, config)`
- `patch(url, data, config)`

### 5. Correção da função principal `request`
**Problema:** A função não suportava corretamente as duas sobrecargas: `(config)` e `(url, config?)`.

**Solução:** Implementada lógica de detecção de tipo para suportar ambas as formas de chamada, com tratamento adequado para extrair a URL do config quando necessário.

## Por que foi feito

Os erros estavam impedindo a compilação do projeto TypeScript e causando problemas de tipo que afetariam o uso da biblioteca. As correções garantem:

1. **Compatibilidade:** Uso de APIs nativas do JavaScript moderno (`URLSearchParams`) em vez de módulos Node.js específicos
2. **Type Safety:** Tipos corretos que refletem o uso real da API
3. **Flexibilidade:** Suporte adequado às sobrecargas de função para diferentes formas de uso
4. **Manutenibilidade:** Código mais claro e fácil de entender

## Arquivos modificados

1. `src/types.ts` - Adicionada propriedade `url` ao `R3qRequestConfig`
2. `src/index.ts` - Corrigidos todos os erros de tipo e implementação

## Resultado

✅ Todos os 10 erros de lint foram corrigidos  
✅ O projeto agora compila sem erros  
✅ A API mantém compatibilidade com o uso existente  
✅ Melhorias na detecção de tipos de body para suporte a diferentes formatos

## Técnicas utilizadas

- **Type Guards:** Uso de `typeof` para verificar tipos em runtime
- **Type Assertions:** Uso de type assertions quando necessário para ajudar o TypeScript
- **API Nativa:** Substituição de dependências externas por APIs nativas do JavaScript
- **Instanceof Checks:** Verificação explícita de tipos de objetos para BodyInit
- **Overload Support:** Implementação de suporte a múltiplas assinaturas de função
